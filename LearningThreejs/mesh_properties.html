<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
    <style>
        body {
            background-color: #ffffff;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
    </style>
    <script src="common/three.js"></script>
    <script src="common/stats.js"></script>
    <script src="common/dat.gui.js"></script>
    <script>
        (function(W){
            var doc = W['document'], screenW, screenH, docEl, docBody,
                scene = new THREE.Scene(),
                renderer = new THREE.WebGLRenderer(),
                cube = new THREE.Mesh(
                    new THREE.BoxGeometry( 5, 8, 3 ),
                    new THREE.MeshLambertMaterial({color:0x44FF44})
                ),
                controls, folder, conX, conY, conZ, camera, stats, t0;

            function init(){
                var plane = new THREE.Mesh(
                            new THREE.PlaneBufferGeometry( 60, 40, 1, 1),
                            new THREE.MeshLambertMaterial({color:0xFFFFFF})
                    ),
                    ambientLight = new THREE.AmbientLight(0x0C0C0C),
                    spotLight = new THREE.SpotLight(0xFFFFFF),
                    gui = new dat.GUI();

                docEl = doc.documentElement, docBody = doc.body;

                screenW = W['innerWidth']  || docEl['clientWidth']  || docBody['clientWidth'];
                screenH = W['innerHeight'] || docEl['clientHeight'] || docBody['clientHeight'];

                renderer.setClearColor( new THREE.Color(0xEEEEEE), 1.0 );
                renderer.setSize( screenW, screenH );
                renderer.shadowMapEnabled = true;

                scene.add( new THREE.AxisHelper(20) );

                plane.rotation.x = -0.5 * Math.PI;
                plane.position.x = 0;
                plane.position.y = 0;
                plane.position.z = 0;
                plane.receiveShadow = true;
                scene.add(plane);

                camera = new THREE.PerspectiveCamera( 45, screenW / screenH, 0.1, 1000);
                camera.position.x = -30;
                camera.position.y = 40;
                camera.position.z = 30;
                camera.lookAt(scene.position);

                scene.add(ambientLight);

                spotLight.position.set( -40, 60, 20 );
                spotLight.castShadow = true;
                scene.add(spotLight);

                controls = new function(){
                    this.scaleX = 1;
                    this.scaleY = 1;
                    this.scaleZ = 1;

                    this.positionX = 0;
                    this.positionY = 4;
                    this.positionZ = 0;

                    this.rotationX = 0;
                    this.rotationY = 0;
                    this.rotationZ = 0;
                    this.scale = 1;

                    this.translateX = 0;
                    this.translateY = 0;
                    this.translateZ = 0;

                    this.visible = true;

                    this.translate = function(){
                        cube.translateX(controls.translateX);
                        cube.translateY(controls.translateY);
                        cube.translateZ(controls.translateZ);

                        controls.positionX = cube.position.x;
                        controls.positionY = cube.position.y;
                        controls.positionZ = cube.position.z;
                    };
                };

                cube.position.y = 4;
                cube.castShadow = true;
                scene.add(cube);

                folder = gui.addFolder('scale');
                folder.add( controls, 'scaleX', 0, 5 );
                folder.add( controls, 'scaleY', 0, 5 );
                folder.add( controls, 'scaleZ', 0, 5 );

                folder = gui.addFolder('position');
                conX = folder.add( controls, 'positionX', -10, 10 );
                conY = folder.add( controls, 'positionY', -4, 20 );
                conZ = folder.add( controls, 'positionZ', -10, 10 );

                conX.listen();
                conX.onChange( function(val){
                    cube.position.x = controls.positionX;
                } );

                conY.listen();
                conY.onChange( function(val){
                    cube.position.y = controls.positionY;
                } );

                conZ.listen();
                conZ.onChange( function(val){
                    cube.position.z = controls.positionZ;
                } );

                folder = gui.addFolder('rotation');
                folder.add( controls, 'rotationX', -4, 4 );
                folder.add( controls, 'rotationY', -4, 4 );
                folder.add( controls, 'rotationZ', -4, 4 );

                folder = gui.addFolder('translate');
                folder.add( controls, 'translateX', -10, 10 );
                folder.add( controls, 'translateY', -10, 10 );
                folder.add( controls, 'translateZ', -10, 10 );
                folder.add( controls, 'translate' );

                gui.add( controls, 'visible' );

                docBody.appendChild(renderer.domElement);

                initStats();
                renderScene();
            }

            function renderScene(){
                var sw = W['innerWidth']  || docEl['clientWidth']  || docBody['clientWidth'],
                    sh = W['innerHeight'] || docEl['clientHeight'] || docBody['clientHeight'];

                if( screenW != sw || screenH != sh ){
                    camera.aspect = sw / sh;
                    camera.updateProjectionMatrix();
                    renderer.setSize( sw, sh );
                    screenW = sw, screenH = sh;
                }

                stats.update();

                cube.visible = controls.visible;

                cube.rotation.x = controls.rotationX;
                cube.rotation.y = controls.rotationY;
                cube.rotation.z = controls.rotationZ;

                cube.scale.set( controls.scaleX, controls.scaleY, controls.scaleZ );

                requestAnimationFrame(renderScene);
                renderer.render( scene, camera );
            }

            function initStats(){
                stats = new Stats();
                stats.setMode(0);

                stats.domElement.style.position = 'absolute';
                stats.domElement.style.left = '0px';
                stats.domElement.style.top = '0px';

                docBody.appendChild(stats.domElement);
            }

            t0 = setInterval( function(){
                switch( doc.readyState ){
                    case'complete':case'loaded':break;
                    case'interactive':if( doc.documentElement.doScroll ) try{doc.documentElement.doScroll('left');}catch(e){return;}
                    default:return;
                }
                clearInterval(t0);
                init();
            }, 1 );
        })(this);
    </script>
</head>
<body>
</body>
</html>